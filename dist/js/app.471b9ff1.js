(function(e){function t(t){for(var a,r,c=t[0],s=t[1],u=t[2],l=0,p=[];l<c.length;l++)r=c[l],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&p.push(o[r][0]),o[r]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a]);d&&d(t);while(p.length)p.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],a=!0,r=1;r<n.length;r++){var c=n[r];0!==o[c]&&(a=!1)}a&&(i.splice(t--,1),e=s(s.s=n[0]))}return e}var a={},r={app:0},o={app:0},i=[];function c(e){return s.p+"js/"+({}[e]||e)+"."+{"chunk-1c63f765":"682767db","chunk-2d2086b7":"1e68c301","chunk-2d22d746":"2cf13b7b","chunk-6cbaac3a":"9d5a184d"}[e]+".js"}function s(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(e){var t=[],n={"chunk-1c63f765":1,"chunk-6cbaac3a":1};r[e]?t.push(r[e]):0!==r[e]&&n[e]&&t.push(r[e]=new Promise((function(t,n){for(var a="css/"+({}[e]||e)+"."+{"chunk-1c63f765":"dec37b04","chunk-2d2086b7":"31d6cfe0","chunk-2d22d746":"31d6cfe0","chunk-6cbaac3a":"a1fb78f8"}[e]+".css",o=s.p+a,i=document.getElementsByTagName("link"),c=0;c<i.length;c++){var u=i[c],l=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(l===a||l===o))return t()}var p=document.getElementsByTagName("style");for(c=0;c<p.length;c++){u=p[c],l=u.getAttribute("data-href");if(l===a||l===o)return t()}var d=document.createElement("link");d.rel="stylesheet",d.type="text/css",d.onload=t,d.onerror=function(t){var a=t&&t.target&&t.target.src||o,i=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");i.code="CSS_CHUNK_LOAD_FAILED",i.request=a,delete r[e],d.parentNode.removeChild(d),n(i)},d.href=o;var f=document.getElementsByTagName("head")[0];f.appendChild(d)})).then((function(){r[e]=0})));var a=o[e];if(0!==a)if(a)t.push(a[2]);else{var i=new Promise((function(t,n){a=o[e]=[t,n]}));t.push(a[2]=i);var u,l=document.createElement("script");l.charset="utf-8",l.timeout=120,s.nc&&l.setAttribute("nonce",s.nc),l.src=c(e);var p=new Error;u=function(t){l.onerror=l.onload=null,clearTimeout(d);var n=o[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;p.message="Loading chunk "+e+" failed.\n("+a+": "+r+")",p.name="ChunkLoadError",p.type=a,p.request=r,n[1](p)}o[e]=void 0}};var d=setTimeout((function(){u({type:"timeout",target:l})}),12e4);l.onerror=l.onload=u,document.head.appendChild(l)}return Promise.all(t)},s.m=e,s.c=a,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(n,a,function(t){return e[t]}.bind(null,a));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s.oe=function(e){throw console.error(e),e};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],l=u.push.bind(u);u.push=t,u=u.slice();for(var p=0;p<u.length;p++)t(u[p]);var d=l;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";n("f0a0")},"041a":function(e,t,n){},"0696":function(e,t,n){},1:function(e,t){},"1a5d":function(e,t,n){var a={"./About.vue":["f820","chunk-2d22d746"],"./AddModulesDialog.vue":["156f","chunk-1c63f765"],"./ApplyLicence.vue":["5e18","chunk-6cbaac3a"],"./Home.vue":["bb51"],"./LicenceCodeDialog.vue":["a63b"],"./Login.vue":["a55b","chunk-2d2086b7"]};function r(e){if(!n.o(a,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],r=t[0];return Promise.all(t.slice(1).map(n.e)).then((function(){return n(r)}))}r.keys=function(){return Object.keys(a)},r.id="1a5d",e.exports=r},"21bb":function(e,t,n){"use strict";n("d8ca")},"399a":function(e,t,n){"use strict";n("041a")},4716:function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("6a61");var a=n("2e91"),r=(n("44a9"),n("3a99"),n("2c238"),n("6ae4"),n("a593")),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("keep-alive",[e.$route.meta.keepAlive?n("router-view"):e._e()],1),e.$route.meta.keepAlive?e._e():n("router-view")],1)},i=[],c=(n("034f"),n("5d22")),s={},u=Object(c["a"])(s,o,i,!1,null,null,null),l=u.exports,p=(n("bc4a"),n("8aaf")),d=n("bb51");r["default"].use(p["a"]);var f=function(e){return function(){return n("1a5d")("./".concat(e,".vue"))}},h=[{path:"/",name:"Home",component:d["default"],meta:{keepAlive:!0}},{path:"/login",name:"Login",component:f("Login")},{path:"/apply",name:"Apply",component:f("ApplyLicence"),meta:{keepAlive:!1}}],m=new p["a"]({mode:"history",base:"",routes:h}),v=m,y=n("7736");r["default"].use(y["a"]);var g=new y["a"].Store({state:{userAccessToken:"",userInfo:""},mutations:{setUserAccessToken:function(e,t){e.userAccessToken=t},setUserInfo:function(e,t){e.userInfo=t}},actions:{},modules:{}}),b=(n("5a8b"),n("4716"),n("a75e"),n("6255")),w=n.n(b),L=(n("a675"),n("8ca8"),n("38bc")),k=n.n(L),C=(n("70e7"),n("af60"),n("cc16"),n("425f"),n("c12e"),n("48d1"),n("8204")),D=n("d487"),_=D["a"].systemUrl,S=(D["a"].openapiUrl,D["a"].qyapiUrl);function O(){var e="".concat(_,"/api/v1/getToken");return C["a"].get(e)}function I(e,t){var n=encodeURIComponent("".concat(S,"/user/getuserinfo?access_token=").concat(e,"&code=").concat(t)),a="".concat(_,"/api/v1/url?url=").concat(n);return C["a"].get(a)}function x(e,t){var n=encodeURIComponent("".concat(S,"/user/get?access_token=").concat(e,"&userid=").concat(t)),a="".concat(_,"/api/v1/url?url=").concat(n);return C["a"].get(a)}function N(){var e="".concat(_,"/api/v1/getCorpId");return C["a"].get(e)}var j=n("e04f"),A=n.n(j),U="Authorization";function E(){return A.a.get(U)}function $(e){return A.a.set(U,e)}var q=D["a"].systemUrl;function P(e){var t="".concat(q,"/api/v1/searchUser");return C["a"].post(t,e)}function T(){return R.apply(this,arguments)}function R(){return R=Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,O().then(function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,g.commit("setUserAccessToken",t.access_token);case 2:return e.next=4,$(t.access_token);case 4:return e.next=6,M();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)}))),R.apply(this,arguments)}function M(){return F.apply(this,arguments)}function F(){return F=Object(a["a"])(regeneratorRuntime.mark((function e(){var t,n,a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t="https://open.weixin.qq.com/connect/oauth2/authorize",e.next=3,N();case 3:n=e.sent,a=encodeURIComponent(window.location.href),r="".concat(t,"?appid=").concat(n,"&redirect_uri=").concat(a,"&response_type=code&scope=snsapi_base&state=STATE#wechat_redirect"),window.location.href=r;case 7:case"end":return e.stop()}}),e)}))),F.apply(this,arguments)}var J=window.location.href,B=JSON.parse(sessionStorage.getItem("qyUserInfo"));if(null!=B&&void 0===B.userIdentify&&sessionStorage.setItem("qyUserInfo",null),-1!==J.indexOf("code=")&&null===JSON.parse(sessionStorage.getItem("qyUserInfo"))){var H=J.split("code=")[1].split("&")[0],V=E();I(V,H).then((function(e){if("ok"===e.errmsg){var t=e.UserId;x(V,t).then((function(e){if("ok"===e.errmsg){var t={department:e.department[0],other:e.alias,userIdentify:e.userid,userName:e.name};sessionStorage.setItem("qyUserInfo",JSON.stringify(t)),P(t).then(function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,g.commit("setUserInfo",t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}))}}))}else if(null===JSON.parse(sessionStorage.getItem("qyUserInfo")))T();else{var z=JSON.parse(sessionStorage.getItem("qyUserInfo"));P(z).then(function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,g.commit("setUserInfo",t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}var K=n("5a4b");r["default"].use(K["a"]),r["default"].config.productionTip=!1,r["default"].use(w.a),v.beforeEach(function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t,n,a){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:k.a.start(),a();case 2:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}()),v.afterEach((function(){k.a.done()})),new r["default"]({router:v,store:g,render:function(e){return e(l)}}).$mount("#app")},"5a8b":function(e,t,n){},8204:function(e,t,n){"use strict";n("bc4a");var a=n("82ae"),r=n.n(a),o=n("6255"),i=r.a.create({});i.defaults.withCredentials=!1,i.interceptors.request.use((function(e){return e}),(function(e){return Promise.reject(e)})),i.interceptors.response.use((function(e){var t=e.data;return t}),(function(e){var t=e.message,n=e.response,a=null;if(n)switch(n.data.status){case 404:a="";break;case 400:a="错误的请求";break;default:a=n.data.message;break}else a=t;return Object(o["Message"])({message:a,type:"error",duration:5e3,showClose:!0}),Promise.reject(a)})),t["a"]=i},"865c":function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return c})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return l}));n("af60");var a=n("8204"),r=n("d487"),o=r["a"].systemUrl;function i(e,t){var n="".concat(o,"/api/v1/getOrder?userIdentify=").concat(e,"&approvalStatus=").concat(t);return a["a"].get(n)}function c(e){var t="".concat(o,"/api/v1/createOrder");return a["a"].post(t,e)}function s(e,t,n){var r="".concat(o,"/api/v1/approvalOrder?orderIdentify=").concat(e,"&approvalStatus=").concat(t,"&rejectedDescription=").concat(n);return a["a"].get(r)}function u(){var e="".concat(o,"/api/v1/getModulesList");return a["a"].get(e)}function l(e){var t="".concat(o,"/api/v1/downloadLicenceCode?orderIdentify=").concat(e);return a["a"].get(t)}},"8ca8":function(e,t,n){},"9c2a":function(e,t,n){"use strict";n("0696")},a63b:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"licencecode-dialog-wrap"},[n("el-dialog",{attrs:{title:"查看许可码",visible:e.dialogVisible,width:"80%","show-close":!1,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("el-input",{attrs:{type:"textarea",readonly:""},model:{value:e.licenceCode,callback:function(t){e.licenceCode=t},expression:"licenceCode"}}),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{staticClass:"tag",attrs:{type:"primary",size:"small",plain:""},on:{click:function(t){return e.copyLink(e.licenceCode)}}},[e._v("复制")]),n("el-button",{attrs:{type:"primary",size:"small",plain:""},on:{click:e.close}},[e._v(" 取消")])],1)],1)],1)},r=[],o=n("f348"),i=n.n(o),c=n("865c"),s={props:{dialogVisible:{default:!1},licenceProp:{default:""}},watch:{dialogVisible:function(e){!0===e&&(this.licenceCode=this.licenceProp.licenseCode)}},data:function(){return{licenceCode:""}},methods:{close:function(){this.$emit("closeLicenceCodeDialog")},copyLink:function(e){var t=this,n=new i.a(".tag",{text:function(){return e}});n.on("success",(function(){t.$message({message:"复制成功",showClose:!0,type:"success"}),n.destroy()})),n.on("error",(function(){t.$message({message:"复制失败,",showClose:!0,type:"error"}),n.destroy()}))},downLoadCode:function(){var e=this;Object(c["b"])(this.licenceProp.orderIdentify).then((function(){e.$message.success("下载许可码成功")}))}}},u=s,l=(n("9c2a"),n("5d22")),p=Object(l["a"])(u,a,r,!1,null,null,null);t["default"]=p.exports},a75e:function(e,t,n){},bb51:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home-wrap"},[n("div",{staticClass:"home-wrap-main"},["apply"==e.operation?n("el-tabs",{attrs:{type:"card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[n("el-tab-pane",{attrs:{label:"已审批",name:"1"}},[n("ApplyList",{directives:[{name:"loading",rawName:"v-loading",value:e.loadData,expression:"loadData"}],attrs:{dataList:e.promiseDataList},on:{showLicenceCode:e.showLicenceCode,showLicenceDetail:e.showLicenceDetail}})],1),n("el-tab-pane",{attrs:{label:"待审批",name:"0"}},[n("ApplyList",{directives:[{name:"loading",rawName:"v-loading",value:e.loadData,expression:"loadData"}],attrs:{dataList:e.promiseDataList},on:{showLicenceDetail:e.showLicenceDetail}})],1)],1):e._e(),"approval"==e.operation?n("el-tabs",{attrs:{type:"card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[n("el-tab-pane",{attrs:{label:"待处理",name:"0"}},[n("ApplyList",{directives:[{name:"loading",rawName:"v-loading",value:e.loadData,expression:"loadData"}],attrs:{dataList:e.promiseDataList},on:{showLicenceDetail:e.approvalLicenceApply}})],1),n("el-tab-pane",{attrs:{label:"已处理",name:"1"}},[n("ApplyList",{directives:[{name:"loading",rawName:"v-loading",value:e.loadData,expression:"loadData"}],attrs:{dataList:e.promiseDataList},on:{showLicenceCode:e.showLicenceCode,showLicenceDetail:e.showLicenceDetail}})],1)],1):e._e()],1),n("div",{staticClass:"home-wrap-footer"},["apply"===e.operation&&"0"===e.userInfo.authority?n("span",{staticClass:"icon iconfont icon-index",staticStyle:{color:"#409EFF"}}):e._e(),"apply"!==e.operation&&"0"===e.userInfo.authority?n("span",{staticClass:"icon iconfont icon-shouye",on:{click:e.goBackHome}}):e._e(),n("span",{staticClass:"icon iconfont icon-plus1",staticStyle:{color:"#409EFF"},on:{click:e.applyLicence}}),"approval"!==e.operation&&"0"===e.userInfo.authority?n("span",{staticClass:"icon iconfont icon-seal",on:{click:e.adminApproval}}):e._e(),"approval"===e.operation&&"0"===e.userInfo.authority?n("span",{staticClass:"icon iconfont icon-seal3",staticStyle:{color:"#409EFF"}}):e._e()]),n("LicenceCodeDialog",{attrs:{dialogVisible:e.isLicenceNumberDialogShow,licenceProp:e.currentLicence},on:{closeLicenceCodeDialog:e.closeLicenceCodeDialog}})],1)},r=[],o=(n("bf00"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"apply-wrap"},[0===e.dataListKeys.length?n("div",{staticStyle:{"margin-top":"100px"}},[e._v(" 暂无数据 ")]):n("ul",e._l(e.dataList,(function(t,a){return n("li",{key:a},[n("div",{staticStyle:{float:"left",width:"60%"},on:{click:function(n){return e.showLicenceDetail(t)}}},[n("p",{attrs:{title:t.programName}},[n("span",{staticClass:"long-text-style"},[e._v(" "+e._s(t.programName)+" ")])]),n("p",{attrs:{title:t.customerName}},[n("span",{staticClass:"long-text-style"},[e._v(" "+e._s(t.customerName)+" ")])]),n("p",{staticClass:"long-text-style",class:{"promise-style":"1"===t.approvalStatus,"reject-style":"2"===t.approvalStatus,"unpromise-style":"0"===t.approvalStatus},attrs:{title:e.statusMap[t.approvalStatus]+("2"===t.approvalStatus?",  拒绝理由："+t.rejectedDescription:"")}},[e._v(" "+e._s(e.statusMap[t.approvalStatus])+e._s("2"===t.approvalStatus?", 拒绝理由："+t.rejectedDescription:"")+" ")])]),n("div",{staticClass:"apply-wrap-time",on:{click:function(n){return e.showLicenceDetail(t)}}},[e._v(" "+e._s(t.updateTime)+" ")]),"1"===t.approvalStatus?n("div",{staticStyle:{float:"left",width:"10%","line-height":"100px"}},[n("span",{staticClass:"icon iconfont icon-more",on:{click:function(n){return e.showLicenceCode(t)}}})]):e._e(),n("div",{staticStyle:{clear:"both"}})])})),0)])}),i=[],c=(n("d319"),{props:{dataList:{default:[]}},computed:{dataListKeys:function(){return Object.keys(this.dataList)}},data:function(){return{statusMap:{0:"待审批",1:"已同意",2:"已拒绝"}}},methods:{showLicenceCode:function(e){this.$emit("showLicenceCode",e)},showLicenceDetail:function(e){this.$emit("showLicenceDetail",e)}}}),s=c,u=(n("399a"),n("5d22")),l=Object(u["a"])(s,o,i,!1,null,null,null),p=l.exports,d=n("a63b"),f=n("865c"),h={components:{ApplyList:p,LicenceCodeDialog:d["default"]},activated:function(){void 0!=this.$route.params.orderStatus&&("待审批"===this.$route.params.orderStatus&&(this.activeName="0",this.operation="apply"),"已同意"===this.$route.params.orderStatus&&(this.activeName="1",this.operation="apply")),this.userIdentify&&this.getOrderList(this.activeName)},computed:{userInfo:function(){return this.$store.state.userInfo},userIdentify:function(){return this.$store.state.userInfo.userIdentify}},watch:{activeName:function(e){"1"===e?this.getOrderList(1):this.getOrderList(0)},userIdentify:function(){this.getOrderList(this.activeName)}},data:function(){return{loadData:!0,activeName:"1",dataList:[],promiseDataList:[],unPromiseDataList:[],isLicenceNumberDialogShow:!1,operation:"apply",currentLicence:{}}},methods:{getOrderList:function(e){var t=this;this.userIdentify&&(this.loadData=!0,this.promiseDataList=[],Object(f["d"])(this.userIdentify,e).then((function(e){t.promiseDataList=e,"apply"===t.operation&&(t.promiseDataList=e.filter((function(e){return e.userIdentify.userIdentify===t.userIdentify}))),t.loadData=!1})))},applyLicence:function(){this.$router.push({path:"/apply"})},showLicenceDetail:function(e){"2"===e.approvalStatus&&"apply"===this.operation?this.$router.push({path:"/apply",query:{licenceDetail:e,disabledEdit:!1}}):this.$router.push({path:"/apply",query:{licenceDetail:e,disabledEdit:!0}})},approvalLicenceApply:function(e){this.$router.push({path:"/apply",query:{licenceDetail:e,disabledEdit:!1,operation:this.operation}})},showLicenceCode:function(e){this.currentLicence=e,this.isLicenceNumberDialogShow=!0},closeLicenceCodeDialog:function(){this.isLicenceNumberDialogShow=!1},adminApproval:function(){this.operation="approval",this.activeName="0",this.getOrderList(0)},goBackHome:function(){this.operation="apply",this.activeName="1",this.getOrderList(1)}}},m=h,v=(n("21bb"),Object(u["a"])(m,a,r,!1,null,null,null));t["default"]=v.exports},d487:function(e,t,n){"use strict";n("af60");t["a"]={openapiUrl:"/connect",systemUrl:"".concat(window.location.protocol,"//").concat(window.location.host),qyapiUrl:"https://qyapi.weixin.qq.com/cgi-bin"}},d8ca:function(e,t,n){},f0a0:function(e,t,n){}});
//# sourceMappingURL=app.471b9ff1.js.map